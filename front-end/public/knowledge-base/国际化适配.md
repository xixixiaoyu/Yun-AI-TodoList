# Todo 应用的国际化适配指南

本指南将介绍如何在 Vue 3 + TypeScript 项目中实现国际化（i18n）适配。我们将使用 `vue-i18n` 库来管理多语言支持。

## 1. 安装依赖

首先，确保已经安装了 `vue-i18n`：

```bash
npm install vue-i18n@next
```

## 2. 创建语言文件

在 `src/locales` 目录下创建不同语言的 JSON 文件：

- `en.json`：英文翻译
- `zh.json`：中文翻译

例如：

```json
// src/locales/en.json
{
  "appTitle": "todo",
  "addTodo": "Add Todo",
  "clearCompleted": "Clear Completed",
  "generateSuggestions": "Generate Suggestions",
  "aiPrioritySort": "AI Priority Sort"
}

// src/locales/zh.json
{
  "appTitle": "待办事项",
  "addTodo": "添加待办",
  "clearCompleted": "清除已完成",
  "generateSuggestions": "生成建议",
  "aiPrioritySort": "AI 优先级排序"
}
```

## 3. 配置 i18n

创建 `src/i18n.ts` 文件来配置 i18n：

```typescript
import { createI18n } from 'vue-i18n'
import en from './locales/en.json'
import zh from './locales/zh.json'

const i18n = createI18n({
  legacy: false,
  locale: 'zh', // 设置默认语言
  fallbackLocale: 'en', // 设置回退语言
  messages: {
    en,
    zh,
  },
})

export default i18n
```

## 4. 在 main.ts 中注册 i18n

在 `src/main.ts` 文件中注册 i18n：

```typescript
import { createApp } from 'vue'
import App from './App.vue'
import i18n from './i18n'

createApp(App).use(i18n).mount('#app')
```

## 5. 在组件中使用 i18n

在 Vue 组件中，可以使用 `useI18n` 组合式函数来访问翻译：

```vue
<script setup lang="ts">
import { useI18n } from 'vue-i18n'

const { t } = useI18n()
</script>

<template>
  <h1>{{ t('appTitle') }}</h1>
  <button>{{ t('addTodo') }}</button>
</template>
```

## 6. 动态切换语言

在 `App.vue` 或其他适当的组件中添加语言切换功能：

```vue
<script setup lang="ts">
import { useI18n } from 'vue-i18n'

const { locale } = useI18n()

const toggleLanguage = () => {
  locale.value = locale.value === 'zh' ? 'en' : 'zh'
}
</script>

<template>
  <button @click="toggleLanguage">
    {{ locale === 'zh' ? 'EN' : '中文' }}
  </button>
</template>
```

## 7. 处理动态内容

对于包含动态内容的翻译，可以使用参数：

```json
// en.json
{
  "todoSummary": "{completed} of {total} items completed"
}

// zh.json
{
  "todoSummary": "已完成 {completed}/{total} 项"
}
```

在组件中使用：

```vue
<template>
  <p>{{ t('todoSummary', { completed: 5, total: 10 }) }}</p>
</template>
```

## 8. 处理复数形式

对于需要处理复数形式的翻译，可以使用 Vue I18n 的复数功能：

```json
// en.json
{
  "itemCount": "no items | one item | {count} items"
}

// zh.json
{
  "itemCount": "{count} 项"
}
```

在组件中使用：

```vue
<template>
  <p>{{ $tc('itemCount', 2) }}</p>
</template>
```

## 9. 日期和数字的本地化

使用 Vue I18n 的 `$d` 和 `$n` 函数来本地化日期和数字：

```vue
<template>
  <p>{{ $d(new Date(), 'long') }}</p>
  <p>{{ $n(1000, 'currency') }}</p>
</template>
```

## 10. 测试

为了确保国际化正常工作，可以为不同语言编写测试用例：

```typescript
import { mount } from '@vue/test-utils'
import { createI18n } from 'vue-i18n'
import TodoList from '../TodoList.vue'

describe('TodoList', () => {
  it('displays correct text in English', () => {
    const i18n = createI18n({
      legacy: false,
      locale: 'en',
      messages: {
        en: { appTitle: 'todo' }
      }
    })

    const wrapper = mount(TodoList, {
      global: {
        plugins: [i18n]
      }
    })

    expect(wrapper.find('h1').text()).toBe('todo')
  })

  it('displays correct text in Chinese', () => {
    const i18n = createI18n({
      legacy: false,
      locale: 'zh',
      messages: {
        zh: { appTitle: '待办事项' }
      }
    })

    const wrapper = mount(TodoList, {
      global: {
        plugins: [i18n]
      }
    })

    expect(wrapper.find('h1').text()).toBe('待办事项')
  })
})
```

## 总结

通过以上步骤，我们实现了一个完整的国际化适配方案：

1. 安装并配置 `vue-i18n` 库
2. 创建多语言翻译文件
3. 在 Vue 应用中注册 i18n
4. 在组件中使用翻译函数
5. 实现动态语言切换
6. 处理动态内容和复数形式
7. 本地化日期和数字
8. 编写测试确保国际化正常工作

这种方法不仅实现了基本的多语言支持，还提供了灵活的语言切换和复杂文本处理能力，为用户提供了良好的本地化体验。