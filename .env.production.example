# ===========================================
# Yun AI TodoList - 生产环境配置模板
# ===========================================
#
# 重要提示：
# 1. 复制此文件为 .env.production
# 2. 修改所有密码和密钥为强密码
# 3. 确保所有敏感信息不会提交到版本控制
# ===========================================

# ===========================================
# 应用基础配置
# ===========================================
NODE_ENV=production
PORT=3000
LOG_LEVEL=warn

# 前端 URL（生产环境域名）
FRONTEND_URL=https://yourdomain.com

# API 基础 URL
VITE_API_BASE_URL=/api/v1

# ===========================================
# 数据库配置 - PostgreSQL
# ===========================================
# 重要：请使用强密码（至少 12 个字符，包含大小写字母、数字和特殊字符）
POSTGRES_DB=yun_ai_todolist
POSTGRES_USER=postgres
POSTGRES_PASSWORD=CHANGE_THIS_TO_STRONG_PASSWORD_MIN_12_CHARS

# 数据库连接字符串
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}

# ===========================================
# Redis 配置
# ===========================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_THIS_TO_STRONG_REDIS_PASSWORD

# ===========================================
# JWT 认证配置
# ===========================================
# 重要：请使用强密钥（至少 32 个字符的随机字符串）
# 可以使用以下命令生成：openssl rand -base64 32
JWT_SECRET=CHANGE_THIS_TO_STRONG_JWT_SECRET_MIN_32_CHARS
JWT_EXPIRES_IN=1h
JWT_REFRESH_SECRET=CHANGE_THIS_TO_STRONG_REFRESH_SECRET_MIN_32_CHARS
JWT_REFRESH_EXPIRES_IN=7d

# ===========================================
# 加密配置
# ===========================================
# 生产环境建议使用 12-15 轮
BCRYPT_ROUNDS=12

# ===========================================
# 安全配置
# ===========================================
# CORS 允许的源（生产域名）
CORS_ORIGIN=https://yourdomain.com

# 限流配置
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# 信任的代理（如果使用负载均衡器）
TRUSTED_PROXIES=127.0.0.1,::1

# ===========================================
# 文件上传配置
# ===========================================
MAX_FILE_SIZE=10485760
UPLOAD_PATH=/app/uploads

# ===========================================
# 邮件服务配置（可选）
# ===========================================
# SMTP_HOST=smtp.yourdomain.com
# SMTP_PORT=587
# SMTP_USER=noreply@yourdomain.com
# SMTP_PASS=your-email-password
# SMTP_FROM=noreply@yourdomain.com

# ===========================================
# 监控和日志配置
# ===========================================
# 生产环境建议关闭 Swagger
ENABLE_SWAGGER=false

# 日志文件路径
LOG_FILE_PATH=/app/logs

# Sentry 错误监控（可选）
# SENTRY_DSN=https://your-sentry-dsn

# ===========================================
# SSL/TLS 配置（如果使用 HTTPS）
# ===========================================
# SSL_CERT_PATH=/path/to/cert.pem
# SSL_KEY_PATH=/path/to/key.pem

# ===========================================
# 数据库优化配置
# ===========================================
# 连接池配置
DB_POOL_MIN=5
DB_POOL_MAX=20

# ===========================================
# 缓存配置
# ===========================================
# Redis 缓存 TTL（秒）
CACHE_TTL=3600

# ===========================================
# 备份配置
# ===========================================
# 自动备份间隔（小时）
BACKUP_INTERVAL=24

# 备份保留天数
BACKUP_RETENTION_DAYS=30

# ===========================================
# 性能监控配置
# ===========================================
# 启用性能指标收集
ENABLE_METRICS=true

# 指标收集间隔（秒）
METRICS_INTERVAL=60

# ===========================================
# 安全头配置
# ===========================================
# 内容安全策略
CSP_POLICY="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'"

# HSTS 最大年龄（秒）
HSTS_MAX_AGE=31536000

# ===========================================
# 第三方服务配置（可选）
# ===========================================
# AI 服务 API 密钥
# OPENAI_API_KEY=your-openai-api-key
# DEEPSEEK_API_KEY=your-deepseek-api-key

# 搜索服务 API 密钥
# GOOGLE_SEARCH_API_KEY=your-google-search-api-key
# GOOGLE_SEARCH_ENGINE_ID=your-search-engine-id

# ===========================================
# 部署配置
# ===========================================
# 健康检查超时（秒）
HEALTH_CHECK_TIMEOUT=30

# 优雅关闭超时（秒）
GRACEFUL_SHUTDOWN_TIMEOUT=30

# ===========================================
# 生产环境检查清单
# ===========================================
# □ 所有密码都已更改为强密码
# □ JWT 密钥已生成并设置
# □ 数据库连接已测试
# □ Redis 连接已测试
# □ CORS 源已正确配置
# □ SSL 证书已配置（如果使用 HTTPS）
# □ 邮件服务已配置（如果需要）
# □ 监控服务已配置
# □ 备份策略已实施
# □ 安全扫描已通过
# □ 性能测试已完成
